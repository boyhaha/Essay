(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{434:function(t,s,a){"use strict";a.r(s);var r=a(44),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_42-elasticsearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_42-elasticsearch"}},[t._v("#")]),t._v(" 42-Elasticsearch")]),t._v(" "),a("p",[t._v("é—®é¢˜")]),t._v(" "),a("ol",[a("li",[t._v("è¯´ä¸€è¯´ES\n"),a("ol",[a("li",[t._v("ä¸€ä¸ªå…¼æœ‰")]),t._v(" "),a("li",[t._v("æ˜¯ é¢å‘æ–‡æ¡£å‹æ•°æ®åº“")]),t._v(" "),a("li",[t._v("é‡‡ç”¨å€’æ’ç´¢å¼•ï¼Œ")]),t._v(" "),a("li",[a("strong",[t._v("å¦‚æœéœ€è¦ä¸­åˆ†åˆ†æ”¯éœ€è¦å®‰è£…æ’ä»¶ï¼Œ")])])])]),t._v(" "),a("li",[t._v("ESæœç´¢å¼•æ“Â å¦‚ä½•æ ¹æ®æ–‡æ¡£ä¸­çš„typeè¿›è¡Œï¼š")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("2.2 æŸ¥è¯¢æŸä¸ªindexä¸‹æ‰€æœ‰çš„type:Â \n$ curl localhost:9200/films/_searchÂ \n\n2.3 æŸ¥è¯¢æŸä¸ªindex ä¸‹ï¼Œ æŸä¸ª typeä¸‹æ‰€æœ‰çš„è®°å½•ï¼šÂ \n$ curl localhost:9200/films/md/_search?pretty=trueÂ \n\n")])])]),a("ul",[a("li",[t._v("ESå®ç°\n"),a("ol",[a("li",[t._v("Elasticsearch ä¸æ”¯æŒå¯¹ä¸­æ–‡è¿›è¡Œåˆ†è¯å»ºç«‹ç´¢å¼•ï¼ˆå€’æ’ç´¢å¼•ï¼š"),a("strong",[t._v("ä¹Ÿå¸¸è¢«ç§°ä¸ºåå‘ç´¢å¼•ã€ç½®å…¥æ¡£æ¡ˆæˆ–åå‘æ¡£æ¡ˆï¼Œæ˜¯ä¸€ç§ç´¢å¼•æ–¹æ³•ï¼Œè¢«ç”¨æ¥å­˜å‚¨åœ¨å…¨æ–‡æœç´¢ä¸‹æŸä¸ªå•è¯åœ¨ä¸€ä¸ªæ–‡æ¡£æˆ–è€…ä¸€ç»„æ–‡æ¡£ä¸­çš„å­˜å‚¨ä½ç½®çš„æ˜ å°„")]),t._v("ï¼‰ï¼Œéœ€è¦é…åˆæ‰©å±•\n"),a("ul",[a("li",[t._v("./bin/elasticsearch-plugin install"),a("a",{attrs:{href:"https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.3.0/elasticsearch-analysis-ik-6.3.0.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.3.0/elasticsearch-analysis-ik-6.3.0.zip"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[t._v("ä¿®æ”¹é…ç½®æ–‡ä»¶")]),t._v(" "),a("li",[t._v("ä½¿ç”¨haystackÂ å¯¹æ¥Elasticsearch\n"),a("ol",[a("li",[t._v("Haystackä¸ºDjangoæä¾›äº†æ¨¡å—åŒ–çš„æœç´¢ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç»Ÿä¸€çš„ï¼Œç†Ÿæ‚‰çš„APIï¼Œå¯ä»¥è®©ä½ åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸åŒçš„æœç´¢åç«¯ï¼ˆæ¯”å¦‚ Solr, Elasticsearch, Whoosh, Xapian ç­‰ç­‰ï¼‰")]),t._v(" "),a("li",[t._v("pip install elasticsearch==2.4.1\npip install drf-haystackdrf-haystackæ˜¯ä¸ºäº†åœ¨REST frameworkä¸­ä½¿ç”¨haystackè€Œè¿›è¡Œçš„å°è£…ï¼ˆå¦‚æœåœ¨Djangoä¸­ä½¿ç”¨haystackï¼Œåˆ™å®‰è£…django-haystackå³å¯ï¼‰")]),t._v(" "),a("li",[t._v("æ³¨å†Œåº”ç”¨")]),t._v(" "),a("li",[t._v("åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®haystackä½¿ç”¨çš„æœç´¢å¼•æ“åç«¯\n"),a("ul",[a("li",[t._v("HAYSTACK_SIGNAL_PROCESSOR ='haystack.signals.RealtimeSignalProcessor'\n"),a("h1",{attrs:{id:"å½“æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤æ•°æ®æ—¶-è‡ªåŠ¨ç”Ÿæˆç´¢å¼•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å½“æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤æ•°æ®æ—¶-è‡ªåŠ¨ç”Ÿæˆç´¢å¼•"}},[t._v("#")]),t._v(" å½“æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤æ•°æ®æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆç´¢å¼•")])])])]),t._v(" "),a("li",[t._v("åˆ›å»ºç´¢å¼•ç±»\n"),a("ul",[a("li",[t._v("æŒ‡æ˜è®©æœç´¢å¼•æ“å¯¹å“ªäº›å­—æ®µå»ºç«‹ç´¢å¼•")]),t._v(" "),a("li",[t._v("text = indexes.CharField(document=True, use_template=True)\n"),a("ul",[a("li",[t._v("document=Trueï¼Œè¡¨åè¯¥å­—æ®µæ˜¯ä¸»è¦è¿›è¡Œå…³é”®å­—æŸ¥è¯¢çš„å­—æ®µ")]),t._v(" "),a("li",[t._v("use_template=True è¡¨ç¤ºåç»­é€šè¿‡æ¨¡æ¿æ¥æŒ‡æ˜ ç´¢å¼•å€¼å…·ä½“ç”±å“ªäº›æ¨¡å‹ç±»å­—æ®µç»„æˆ")])])])])]),t._v(" "),a("li",[t._v("åˆ›å»ºtextå­—æ®µä½¿ç”¨çš„æ¨¡æ¿æ–‡ä»¶")]),t._v(" "),a("li",[t._v("æ‰‹åŠ¨ç”Ÿæˆåˆå§‹ç´¢å¼•\n"),a("ul",[a("li",[t._v("python manage.py rebuild_index")])])]),t._v(" "),a("li",[t._v("åˆ›å»ºåºåˆ—åŒ–å™¨")]),t._v(" "),a("li",[t._v("åˆ›å»ºè§†å›¾")]),t._v(" "),a("li",[t._v("å®šä¹‰è·¯ç”±")])])])])])]),t._v(" "),a("p",[t._v("å¼€æºçš„Â "),a("a",{attrs:{href:"https://blog.csdn.net/cnweike/article/details/33736429",target:"_blank",rel:"noopener noreferrer"}},[t._v("Elasticsearch"),a("OutboundLink")],1),t._v("Â æ˜¯ç›®å‰å…¨æ–‡æœç´¢å¼•æ“çš„é¦–é€‰")]),t._v(" "),a("p",[t._v("å®ƒå¯ä»¥å¿«é€Ÿåœ°å‚¨å­˜ã€æœç´¢å’Œåˆ†ææµ·é‡æ•°æ®ã€‚ç»´åŸºç™¾ç§‘ã€Stack Overflowã€Github éƒ½é‡‡ç”¨å®ƒ")]),t._v(" "),a("p",[t._v("Elastic æ˜¯ Lucene çš„å°è£…ï¼Œæä¾›äº† REST API çš„æ“ä½œæ¥å£ï¼Œå¼€ç®±å³ç”¨ã€‚"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Elasticsearch æ˜¯ç”¨Javaå®ç°çš„ã€‚")]),t._v(" "),a("p",[t._v("elasticsearch æ˜¯ä¸€ä¸ªå…¼æœ‰æœç´¢å¼•æ“å’ŒNoSQLæ•°æ®åº“åŠŸèƒ½çš„å¼€æºç³»ç»Ÿï¼ŒåŸºäºJava/Luceneæ„å»ºï¼Œå¯ä»¥ç”¨äºå…¨æ–‡æœç´¢ï¼Œç»“æ„åŒ–æœç´¢ä»¥åŠè¿‘å®æ—¶åˆ†æã€‚å¯ä»¥è¯´Luceneæ˜¯å½“ä»Šæœ€å…ˆè¿›ï¼Œæœ€é«˜æ•ˆçš„å…¨åŠŸèƒ½å¼€æºæœç´¢å¼•æ“æ¡†æ¶ã€‚ è¯´æ˜ï¼š Luceneï¼šåªæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œè¦å……åˆ†åˆ©ç”¨å®ƒçš„åŠŸèƒ½ï¼Œéœ€è¦ä½¿ç”¨JAVAï¼Œå¹¶ä¸”åœ¨ç¨‹åºä¸­é›†æˆLuceneï¼Œå­¦ä¹ æˆæœ¬é«˜ï¼ŒLuceneç¡®å®éå¸¸å¤æ‚ã€‚ Elasticsearch æ˜¯ é¢å‘æ–‡æ¡£å‹æ•°æ®åº“ï¼Œè¿™æ„å‘³ç€å®ƒå­˜å‚¨çš„æ˜¯æ•´ä¸ªå¯¹è±¡æˆ–è€… æ–‡æ¡£ï¼Œå®ƒä¸ä½†ä¼šå­˜å‚¨å®ƒä»¬ï¼Œè¿˜ä¼šä¸ºä»–ä»¬å»ºç«‹ç´¢å¼•ï¼Œè¿™æ ·ä½ å°±å¯ä»¥æœç´¢ä»–ä»¬äº†ã€‚ åœ¨é€šè¿‡æœç´¢å¼•æ“æœç´¢æ—¶ï¼Œæœç´¢å¼•æ“å°†å…³é”®å­—åœ¨ç´¢å¼•æ•°æ®ä¸­è¿›è¡Œå¿«é€Ÿå¯¹æ¯”æŸ¥æ‰¾ï¼Œè¿›è€Œæ‰¾åˆ°æ•°æ®çš„çœŸå®å­˜å‚¨ä½ç½®")]),t._v(" "),a("h3",{attrs:{id:"elasticsearchçš„index"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearchçš„index"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Elasticsearchçš„index")])]),t._v(" "),a("p",[t._v("Elasticsearchçš„ç´¢å¼•(index)æ˜¯ç”¨äºç»„ç»‡æ•°æ®çš„é€»è¾‘å‘½åç©ºé—´ï¼ˆå¦‚æ•°æ®åº“ï¼‰ã€‚Elasticsearchçš„ç´¢å¼•æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†ç‰‡(shard)ï¼ˆé»˜è®¤ä¸º5ï¼‰ã€‚åˆ†ç‰‡æ˜¯å®é™…å­˜å‚¨æ•°æ®çš„Luceneç´¢å¼•ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªæœç´¢å¼•æ“ã€‚æ¯ä¸ªåˆ†ç‰‡å¯ä»¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå‰¯æœ¬(replicas)ï¼ˆé»˜è®¤ä¸º1ï¼‰ã€‚Elasticsearchç´¢å¼•è¿˜å…·æœ‰â€œç±»å‹â€ï¼ˆå¦‚æ•°æ®åº“ä¸­çš„è¡¨ï¼‰ï¼Œå…è®¸æ‚¨åœ¨ç´¢å¼•ä¸­å¯¹æ•°æ®è¿›è¡Œé€»è¾‘åˆ†åŒºã€‚Elasticsearchç´¢å¼•ä¸­ç»™å®šâ€œç±»å‹â€ä¸­çš„æ‰€æœ‰æ–‡æ¡£(documents)å…·æœ‰ç›¸åŒçš„å±æ€§ï¼ˆå¦‚è¡¨çš„æ¨¡å¼ï¼‰ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdn.net/20170814225416168?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemdfaG92ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast",alt:""}})]),t._v(" "),a("p",[t._v("å›¾aæ˜¾ç¤ºäº†ä¸€ä¸ªç”±ä¸‰ä¸ªä¸»åˆ†ç‰‡ç»„æˆçš„Elasticsearché›†ç¾¤ï¼Œæ¯ä¸ªä¸»åˆ†ç‰‡åˆ†åˆ«æœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚æ‰€æœ‰è¿™äº›åˆ†ç‰‡ä¸€èµ·å½¢æˆä¸€ä¸ªElasticsearchç´¢å¼•ï¼Œæ¯ä¸ªåˆ†ç‰‡æ˜¯Luceneç´¢å¼•æœ¬èº«ã€‚")]),t._v(" "),a("p",[t._v("å›¾bæ¼”ç¤ºäº†Elasticsearchç´¢å¼•ï¼Œåˆ†ç‰‡ï¼ŒLuceneç´¢å¼•å’Œæ–‡æ¡£(document)ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚")]),t._v(" "),a("h4",{attrs:{id:"ç±»æ¯”å…³ç³»æ•°æ®åº“æœ¯è¯­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç±»æ¯”å…³ç³»æ•°æ®åº“æœ¯è¯­"}},[t._v("#")]),t._v(" "),a("strong",[t._v("ç±»æ¯”å…³ç³»æ•°æ®åº“æœ¯è¯­")])]),t._v(" "),a("p",[t._v("Elasticsearch Index ~ Database")]),t._v(" "),a("p",[t._v("Types ~ Tables")]),t._v(" "),a("p",[t._v("Mapping ~ Schema")]),t._v(" "),a("p",[a("strong",[t._v("å…³ç³»æ•°æ®åº“ â‡’ æ•°æ®åº“ â‡’ è¡¨ â‡’ è¡Œ â‡’ åˆ—(Columns)")])]),t._v(" "),a("p",[a("strong",[t._v("Elasticsearch â‡’ ç´¢å¼• â‡’ ç±»å‹ â‡’ æ–‡æ¡£ â‡’ å­—æ®µ(Fields)")])]),t._v(" "),a("p",[t._v("schemaÂ  MySQLçš„æ–‡æ¡£ä¸­æŒ‡å‡ºï¼Œåœ¨ç‰©ç†ä¸Šï¼Œæ¨¡å¼ä¸æ•°æ®åº“æ˜¯åŒä¹‰çš„ï¼Œæ‰€ä»¥ï¼Œæ¨¡å¼å’Œæ•°æ®åº“æ˜¯ä¸€å›äº‹")]),t._v(" "),a("h3",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"ç›®å½•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç›®å½•"}},[t._v("#")]),t._v(" "),a("strong",[t._v("ç›®å½•ï¼š")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("åº”ç”¨åœºæ™¯")])]),t._v(" "),a("li",[a("strong",[t._v("solr VS ES")])]),t._v(" "),a("li",[a("strong",[t._v("æ ¸å¿ƒæ¦‚å¿µ")])]),t._v(" "),a("li",[a("strong",[t._v("ESæ¨¡å—ç»“æ„")])]),t._v(" "),a("li",[a("strong",[t._v("åˆ†ç‰‡ç¤ºä¾‹")])])]),t._v(" "),a("p",[a("strong",[t._v("åº”ç”¨åœºæ™¯")])]),t._v(" "),a("hr"),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ç«™å†…æœç´¢ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("NoSQL jsonæ–‡æ¡£æ•°æ®åº“ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("ç›‘æ§ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("å›½å¤–ï¼šWikipediaä½¿ç”¨ ES æä¾›å…¨æ–‡æœç´¢å¹¶é«˜äº®å…³é”®å­—ã€StackOverflowç»“åˆå…¨æ–‡æœç´¢ä¸åœ°ç†ä½ç½®æŸ¥è¯¢ã€")])]),t._v(" "),a("li",[a("strong",[t._v("å›½å†…ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„å¹³å°ELK(ElasticSearch, Logstash, "),a("strong",[t._v("Kibana")])]),t._v(")****")])]),t._v(" "),a("p",[a("strong",[t._v("solr VS ES")])]),t._v(" "),a("hr"),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Solræ˜¯Apache Luceneé¡¹ç›®çš„å¼€æºä¼ä¸šæœç´¢å¹³å°ã€‚å…¶ä¸»è¦åŠŸèƒ½åŒ…æ‹¬å…¨æ–‡æ£€ç´¢ã€å‘½ä¸­æ ‡ç¤ºã€åˆ†é¢æœç´¢ã€åŠ¨æ€èšç±»ã€æ•°æ®åº“é›†æˆï¼Œä»¥åŠå¯Œæ–‡æœ¬ï¼ˆå¦‚Wordã€PDFï¼‰çš„å¤„ç†ã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("Solræ˜¯é«˜åº¦å¯æ‰©å±•çš„ï¼Œå¹¶æä¾›äº†åˆ†å¸ƒå¼æœç´¢å’Œç´¢å¼•å¤åˆ¶ã€‚Solræ˜¯æœ€æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ï¼ŒSolr4 è¿˜å¢åŠ äº†NoSQLæ”¯æŒã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("Solræ˜¯ç”¨Javaç¼–å†™ã€è¿è¡Œåœ¨Servletå®¹å™¨ï¼ˆå¦‚ Apache Tomcat æˆ–Jettyï¼‰çš„ä¸€ä¸ªç‹¬ç«‹çš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚ Solré‡‡ç”¨äº† Lucene Java æœç´¢åº“ä¸ºæ ¸å¿ƒçš„å…¨æ–‡ç´¢å¼•å’Œæœç´¢ï¼Œå¹¶å…·æœ‰ç±»ä¼¼RESTçš„HTTP/XMLå’ŒJSONçš„APIã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("Solrå¼ºå¤§çš„å¤–éƒ¨é…ç½®åŠŸèƒ½ä½¿å¾—æ— éœ€è¿›è¡ŒJavaç¼–ç ï¼Œä¾¿å¯å¯¹ å…¶è¿›è¡Œè°ƒæ•´ä»¥é€‚åº”å¤šç§ç±»å‹çš„åº”ç”¨ç¨‹åºã€‚Solræœ‰ä¸€ä¸ªæ’ä»¶æ¶æ„ï¼Œä»¥æ”¯æŒæ›´å¤šçš„é«˜çº§å®šåˆ¶")])]),t._v(" "),a("li",[a("strong",[t._v("Elasticsearch ä¸ Solr çš„æ¯”è¾ƒæ€»ç»“")])])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("äºŒè€…å®‰è£…éƒ½å¾ˆç®€å•")])]),t._v(" "),a("li",[a("strong",[t._v("Solr åˆ©ç”¨ Zookeeper è¿›è¡Œåˆ†å¸ƒå¼ç®¡ç†ï¼Œè€Œ Elasticsearch è‡ªèº«å¸¦æœ‰åˆ†å¸ƒå¼åè°ƒç®¡ç†åŠŸèƒ½")])]),t._v(" "),a("li",[a("strong",[t._v("Solr æ”¯æŒæ›´å¤šæ ¼å¼çš„æ•°æ®ï¼Œè€Œ Elasticsearch ä»…æ”¯æŒjsonæ–‡ä»¶æ ¼å¼")])]),t._v(" "),a("li",[a("strong",[t._v("Solr å®˜æ–¹æä¾›çš„åŠŸèƒ½æ›´å¤šï¼Œè€Œ Elasticsearch æœ¬èº«æ›´æ³¨é‡äºæ ¸å¿ƒåŠŸèƒ½ï¼Œé«˜çº§åŠŸèƒ½å¤šæœ‰ç¬¬ä¸‰æ–¹æ’ä»¶æä¾›")])]),t._v(" "),a("li",[a("strong",[t._v("Solr åœ¨ä¼ ç»Ÿçš„æœç´¢åº”ç”¨ä¸­è¡¨ç°å¥½äº Elasticsearchï¼Œä½†åœ¨å¤„ç†å®æ—¶æœç´¢åº”ç”¨æ—¶æ•ˆç‡æ˜æ˜¾ä½äº Elasticsearch")])]),t._v(" "),a("li",[a("strong",[t._v("Solr æ˜¯ä¼ ç»Ÿæœç´¢åº”ç”¨çš„æœ‰åŠ›è§£å†³æ–¹æ¡ˆï¼Œä½† Elasticsearch æ›´é€‚ç”¨äºæ–°å…´çš„å®æ—¶æœç´¢åº”ç”¨")])])]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒæ¦‚å¿µ")])]),t._v(" "),a("hr"),t._v(" "),a("ul",[a("li",[a("strong",[t._v("é›†ç¾¤ï¼ˆCluster):")])])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("é›†ç¾¤å†…èŠ‚ç‚¹ååŒå·¥ä½œï¼Œå…±äº«æ•°æ®ï¼Œå¹¶å…±åŒåˆ†æ‹…å·¥ä½œè´Ÿè·ã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("ç”±äºèŠ‚ç‚¹æ˜¯ä»å±é›†ç¾¤çš„ï¼Œé›†ç¾¤ä¼šè‡ªæˆ‘é‡ç»„æ¥")])]),t._v(" "),a("li",[a("strong",[t._v("cluster Nameæ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹åªèƒ½æ˜¯ç¾¤é›†çš„ä¸€éƒ¨åˆ†ï¼Œå½“è¯¥èŠ‚ç‚¹è¢«è®¾ç½®ä¸ºç›¸åŒçš„åç§°æ—¶ï¼Œå°±ä¼š")])]),t._v(" "),a("li",[a("strong",[t._v("é›†ç¾¤ä¸­é€šè¿‡é€‰ä¸¾äº§ç”Ÿ")])]),t._v(" "),a("li",[a("strong",[t._v("ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®åŒ…æ‹¬ master èŠ‚ç‚¹åœ¨å†…çš„é›†ç¾¤ä¸­çš„ä»»ä¸€èŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½çŸ¥é“å„ä¸ªæ–‡æ¡£çš„ä½ç½®ï¼Œå¹¶èƒ½å¤Ÿå°†æˆ‘ä»¬çš„è¯·æ±‚ç›´æ¥è½¬å‘åˆ°æ‹¥æœ‰æˆ‘ä»¬æƒ³è¦çš„æ•°æ®çš„èŠ‚ç‚¹ã€‚æ— è®ºæˆ‘ä»¬è®¿é—®çš„æ˜¯å“ªä¸ªèŠ‚ç‚¹ï¼Œå®ƒéƒ½ä¼šæ§åˆ¶ä»æ‹¥æœ‰æ•°æ®çš„èŠ‚ç‚¹æ”¶é›†å“åº”çš„è¿‡ç¨‹ï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯æœ€ç»ˆçš„ç»“æœã€‚è¿™ä¸€åˆ‡éƒ½æ˜¯ç”± Elasticsearch é€æ˜ç®¡ç†çš„")])])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("èŠ‚ç‚¹(node):")])]),t._v(" "),a("li",[a("strong",[t._v("ç´¢å¼•ï¼ˆIndex)ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("æ–‡æ¡£ç±»å‹ï¼ˆTypeï¼‰ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("å…³ç³»æ•°æ®åº“ â‡’ æ•°æ®åº“ â‡’ è¡¨ â‡’ è¡Œ â‡’ åˆ—(Columns)")]),t._v(" "),a("strong",[t._v("Elasticsearch â‡’ ç´¢å¼• â‡’ ç±»å‹ â‡’ æ–‡æ¡£ â‡’ å­—æ®µ(Fields)")]),t._v(" "),a("strong",[t._v("æ–‡æ¡£ï¼ˆDocument) ï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("æ¨¡æ‹Ÿç¤ºæ„å›¾å¦‚ï¼š")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161124180138409-1933404824.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("Mappingï¼š")])]),t._v(" "),a("li",[a("strong",[t._v("åˆ†ç‰‡(shard) ï¼š")])])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("åˆ†ç‰‡æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Luceneå®ä¾‹ï¼Œå¹¶ä¸”å®ƒè‡ªèº«ä¹Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„æœç´¢å¼•æ“ã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("æ–‡æ¡£å­˜å‚¨å¹¶ä¸”è¢«ç´¢å¼•åœ¨åˆ†ç‰‡ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç¨‹åºå¹¶ä¸ä¼šç›´æ¥ä¸å®ƒä»¬é€šä¿¡ã€‚å–è€Œä»£ä¹‹ï¼Œå®ƒä»¬ç›´æ¥ä¸ç´¢å¼•è¿›è¡Œé€šä¿¡çš„")])]),t._v(" "),a("li",[a("strong",[t._v("æŠŠ")])]),t._v(" "),a("li",[a("strong",[t._v("åˆ†ç‰‡åˆ†ä¸º ä¸»åˆ†ç‰‡(primary shard) ä»¥åŠ ä»åˆ†ç‰‡(replica shard) ä¸¤ç§ã€‚åœ¨ä½ çš„ç´¢å¼•ä¸­ï¼Œæ¯ä¸€ä¸ªæ–‡æ¡£éƒ½å±äºä¸€ä¸ªä¸»åˆ†ç‰‡")])]),t._v(" "),a("li",[a("strong",[t._v("ä»")])]),t._v(" "),a("li",[a("strong",[t._v("ç´¢å¼•ä¸­çš„")])]),t._v(" "),a("li",[a("strong",[t._v("ä¸€ä¸ªç´¢å¼•é»˜è®¤è®¾ç½®äº†5ä¸ªä¸»åˆ†ç‰‡ï¼Œæ¯ä¸ªä¸»åˆ†ç‰‡æœ‰ä¸€ä¸ªä»åˆ†ç‰‡å¯¹åº”")])])]),t._v(" "),a("p",[a("strong",[t._v("ESæ¨¡å—ç»“æ„")])]),t._v(" "),a("hr"),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æ¨¡å—ç»“æ„å›¾å¦‚ä¸‹")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161124185700128-46209682.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("Gateway:")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("å¯¹äºåˆ†å¸ƒå¼é›†ç¾¤æ¥è¯´ï¼Œå½“ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹downæ‰äº†ï¼Œèƒ½å¤Ÿä¿è¯æˆ‘ä»¬çš„æ•°æ®ä¸èƒ½ä¸¢ï¼Œæœ€é€šç”¨çš„è§£æ”¾æ–¹æ¡ˆå°±æ˜¯å¯¹å¤±è´¥èŠ‚ç‚¹çš„æ•°æ®è¿›è¡Œå¤åˆ¶ï¼Œé€šè¿‡æ§åˆ¶å¤åˆ¶çš„ä»½æ•°å¯ä»¥ä¿è¯é›†ç¾¤æœ‰å¾ˆé«˜çš„å¯ç”¨æ€§ï¼Œå¤åˆ¶è¿™ä¸ªæ–¹æ¡ˆçš„ç²¾é«“ä¸»è¦æ˜¯ä¿è¯æ“ä½œçš„æ—¶å€™æ²¡æœ‰å•ç‚¹ï¼Œå¯¹ä¸€ä¸ªèŠ‚ç‚¹çš„æ“ä½œä¼šåŒæ­¥åˆ°å…¶ä»–çš„å¤åˆ¶èŠ‚ç‚¹ä¸Šå»ã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("$ curl -XPUT")]),a("a",{attrs:{href:"http://localhost:9200/twitter/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:9200/twitter/"),a("OutboundLink")],1),a("strong",[t._v("-d****'")]),t._v(" "),a("strong",[t._v("index :")]),t._v("\n**number_of_shards ğŸ˜—*"),a("strong",[t._v("3")]),t._v("\n**number_of_replicas ğŸ˜—*"),a("strong",[t._v("2")]),t._v(" "),a("strong",[t._v("ESä¸€ä¸ª")])]),t._v(" "),a("li",[a("strong",[t._v("æ¯ä¸ªæ“ä½œä¼šè‡ªåŠ¨è·¯ç”±ä¸»ç¢ç‰‡æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œåœ¨ä¸Šé¢æ‰§è¡Œæ“ä½œï¼Œå¹¶ä¸”åŒæ­¥åˆ°å…¶ä»–å¤åˆ¶èŠ‚ç‚¹ï¼Œé€šè¿‡ä½¿ç”¨â€œnon blocking IOâ€æ¨¡å¼æ‰€æœ‰å¤åˆ¶çš„æ“ä½œéƒ½æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ çš„")])]),t._v(" "),a("li",[a("strong",[t._v("ç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒä¼šå»æŒä¹…åŒ–è®¾å¤‡è¯»å–é›†ç¾¤çš„çŠ¶æ€ä¿¡æ¯ï¼ˆåˆ›å»ºçš„ç´¢å¼•ï¼Œé…ç½®ç­‰ï¼‰ç„¶åæ‰§è¡Œåº”ç”¨å®ƒä»¬ï¼ˆåˆ›å»ºç´¢å¼•ï¼Œåˆ›å»ºmappingæ˜ å°„ç­‰ï¼‰ï¼Œæ¯ä¸€æ¬¡shardèŠ‚ç‚¹ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–åŠ å…¥å¤åˆ¶ç»„ï¼Œå®ƒéƒ½ä¼šä»é•¿æŒä¹…åŒ–å­˜å‚¨é‡Œé¢æ¢å¤å®ƒçš„çŠ¶æ€ä¿¡æ¯")])])])]),t._v(" "),a("li",[a("strong",[t._v("Lucence Directory:ï¿½")]),t._v("ï¿½\n"),a("ol",[a("li",[a("strong",[t._v("å®ƒæ˜¯Luceneå­˜å‚¨çš„ä¸€ä¸ªæŠ½è±¡ï¼Œç”±æ­¤æ´¾ç”Ÿäº†ä¸¤ä¸ªç±»ï¼š")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125104550456-1075794774.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("ä¸€ä¸ªDirectoryå¯¹è±¡æ˜¯ä¸€ä»½æ–‡ä»¶çš„æ¸…å•ã€‚æ–‡ä»¶å¯èƒ½åªåœ¨è¢«åˆ›å»ºçš„æ—¶å€™å†™ä¸€æ¬¡ã€‚ä¸€æ—¦æ–‡ä»¶è¢«åˆ›å»ºï¼Œå®ƒå°†åªè¢«è¯»å–æˆ–è€…åˆ é™¤ã€‚åœ¨è¯»å–çš„æ—¶å€™è¿›è¡Œå†™å…¥æ“ä½œæ˜¯å…è®¸çš„")])])])]),t._v(" "),a("li",[a("strong",[t._v("Discovery")])])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("èŠ‚ç‚¹å¯åŠ¨å")])]),t._v(" "),a("li",[a("strong",[t._v("Pingçš„responseä¼šåŒ…å«è¯¥èŠ‚ç‚¹çš„åŸºæœ¬ä¿¡æ¯ä»¥åŠè¯¥èŠ‚ç‚¹è®¤ä¸ºçš„masterèŠ‚ç‚¹")])]),t._v(" "),a("li",[a("strong",[t._v("é€‰ä¸¾å¼€å§‹ï¼Œå…ˆä»å„èŠ‚ç‚¹è®¤ä¸ºçš„masterä¸­é€‰ï¼Œè§„åˆ™å¾ˆç®€å•ï¼ŒæŒ‰ç…§idçš„å­—å…¸åºæ’åºï¼Œå–ç¬¬ä¸€ä¸ª")])]),t._v(" "),a("li",[a("strong",[t._v("å¦‚æœå„èŠ‚ç‚¹éƒ½æ²¡æœ‰è®¤ä¸ºçš„masterï¼Œåˆ™ä»æ‰€æœ‰èŠ‚ç‚¹ä¸­é€‰æ‹©ï¼Œè§„åˆ™åŒä¸Šã€‚è¿™é‡Œæœ‰ä¸ªé™åˆ¶æ¡ä»¶å°±æ˜¯")])]),t._v(" "),a("li",[a("strong",[t._v("æœ€åé€‰ä¸¾ç»“æœæ˜¯è‚¯å®šèƒ½é€‰ä¸¾å‡ºä¸€ä¸ªmasterï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªlocalèŠ‚ç‚¹é‚£å°±é€‰å‡ºçš„æ˜¯è‡ªå·±")])]),t._v(" "),a("li",[a("strong",[t._v("å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯masterï¼Œåˆ™å¼€å§‹ç­‰å¾…èŠ‚ç‚¹æ•°è¾¾åˆ° minimum_master_nodesï¼Œç„¶åæä¾›æœåŠ¡, å¦‚æœå½“å‰èŠ‚ç‚¹ä¸æ˜¯masterï¼Œåˆ™å°è¯•åŠ å…¥master.")])]),t._v(" "),a("li",[a("strong",[t._v("ESæ”¯æŒä»»æ„æ•°ç›®çš„é›†ç¾¤ï¼ˆ1-Nï¼‰,æ‰€ä»¥ä¸èƒ½åƒ Zookeeper/Etcd é‚£æ ·é™åˆ¶èŠ‚ç‚¹å¿…é¡»æ˜¯å¥‡æ•°ï¼Œä¹Ÿå°±æ— æ³•ç”¨æŠ•ç¥¨çš„æœºåˆ¶æ¥é€‰ä¸»ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªè§„åˆ™ï¼Œåªè¦æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½éµå¾ªåŒæ ·çš„è§„åˆ™ï¼Œå¾—åˆ°çš„ä¿¡æ¯éƒ½æ˜¯å¯¹ç­‰çš„ï¼Œé€‰å‡ºæ¥çš„ä¸»èŠ‚ç‚¹è‚¯å®šæ˜¯ä¸€è‡´çš„. ä½†åˆ†å¸ƒå¼ç³»ç»Ÿçš„é—®é¢˜å°±å‡ºåœ¨")])])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("memcached")])])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("é€šè¿‡memecachedåè®®æ¥è®¿é—®ESçš„æ¥å£,æ”¯æŒäºŒè¿›åˆ¶å’Œæ–‡æœ¬ä¸¤ç§åè®®.é€šè¿‡ä¸€ä¸ªåä¸ºtransport-memcachedæ’ä»¶æä¾›")])]),t._v(" "),a("li",[a("strong",[t._v("Memcachedå‘½ä»¤ä¼šè¢«æ˜ å°„åˆ°RESTæ¥å£ï¼Œå¹¶ä¸”ä¼šè¢«åŒæ ·çš„RESTå±‚å¤„ç†ï¼Œmemcachedå‘½ä»¤åˆ—è¡¨åŒ…æ‹¬ï¼šget/set/delete/quit")])])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("River :")])])]),t._v(" "),a("p",[a("strong",[t._v("åˆ†ç‰‡ç¤ºä¾‹")])]),t._v(" "),a("hr"),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å¯ç”¨ä¸€ä¸ªæ—¢æ²¡æœ‰æ•°æ®ï¼Œä¹Ÿæ²¡æœ‰ç´¢å¼•çš„å•ä¸€èŠ‚ç‚¹, å¦‚ä¸‹å›¾")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125113639190-848778968.png",alt:""}})]),t._v(" "),a("li",[t._v("**PUT /"),a("strong",[a("strong",[t._v("blogs")]),t._v(" "),a("strong",[t._v("{")]),t._v(" "),a("strong",[t._v('"'),a("strong",[a("strong",[t._v("settings")])]),t._v('"')]),t._v("**: {")]),t._v(" "),a("strong",[t._v('"'),a("strong",[a("strong",[t._v("number_of_shards")])]),t._v('"'),a("strong",[a("strong",[t._v(": 3")])]),t._v(",")]),t._v(" "),a("strong",[t._v('"'),a("strong",[a("strong",[t._v("number_of_replicas")])]),t._v('"****: 1')]),t._v(" "),a("strong",[t._v("}")]),t._v(" "),a("strong",[t._v("}")]),t._v(" "),a("strong",[t._v("åœ¨ç©ºçš„å•èŠ‚ç‚¹é›†ç¾¤ä¸­ä¸Šåˆ›å»ºä¸€ä¸ªå«åš blogs çš„ç´¢å¼•ï¼Œè®¾ç½®3ä¸ªä¸»åˆ†ç‰‡å’Œä¸€ç»„ä»åˆ†ç‰‡ï¼ˆæ¯ä¸ªä¸»åˆ†ç‰‡æœ‰ä¸€ä¸ªä»åˆ†ç‰‡å¯¹åº”ï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š")])]),t._v(" "),a("li",[t._v("**Â é›†ç¾¤ç¤ºä¾‹å›¾å¦‚ä¸‹ï¼š ï¼ˆ**")]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125113848987-1256292980.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("ä¸»åˆ†ç‰‡(primary shards) å¯åŠ¨å¹¶ä¸”è¿è¡Œäº†ï¼Œè¿™æ—¶é›†ç¾¤å·²ç»å¯ä»¥æˆåŠŸçš„å¤„ç†ä»»æ„è¯·æ±‚ï¼Œä½†æ˜¯ ä»åˆ†ç‰‡(replica shards) æ²¡æœ‰å®Œå…¨è¢«æ¿€æ´»ã€‚äº‹å®ä¸Šï¼Œå½“å‰è¿™ä¸‰ä¸ªä»åˆ†ç‰‡éƒ½å¤„äº unassignedï¼ˆæœªåˆ†é…ï¼‰çš„çŠ¶æ€ï¼Œå®ƒä»¬è¿˜æœªè¢«åˆ†é…åˆ°èŠ‚ç‚¹ä¸Šã€‚åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šä¿å­˜ç›¸åŒçš„æ•°æ®å‰¯æœ¬æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ•…éšœäº†ï¼Œå°±ç­‰åŒäºæ‰€æœ‰çš„æ•°æ®å‰¯æœ¬ä¹Ÿä¸¢å¤±äº†")])]),t._v(" "),a("li",[a("strong",[t._v("å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼Œé…ç½®ç¬¬äºŒä¸ªèŠ‚ç‚¹ä¸ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„ cluster.name ç›¸åŒï¼ˆ./config/elasticsearch.ymlæ–‡ä»¶ä¸­çš„é…ç½®ï¼‰ï¼Œå®ƒå°±èƒ½è‡ªåŠ¨å‘ç°å¹¶åŠ å…¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ä¸­,å¦‚ä¸‹å›¾ï¼š")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125114323550-385234299.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("cluster-health çš„çŠ¶æ€ä¸º greenï¼Œè¿™æ„å‘³ç€æ‰€æœ‰çš„6ä¸ªåˆ†ç‰‡ï¼ˆä¸‰ä¸ªä¸»åˆ†ç‰‡å’Œä¸‰ä¸ªä»åˆ†ç‰‡ï¼‰éƒ½å·²æ¿€æ´»ï¼Œæ–‡æ¡£åœ¨ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹ä¸Šéƒ½èƒ½è¢«æ£€ç´¢")])]),t._v(" "),a("li",[a("strong",[t._v("éšç€åº”ç”¨éœ€æ±‚çš„å¢é•¿ï¼Œå¯åŠ¨ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹è¿›è¡Œæ¨ªå‘æ‰©å±•ï¼Œé›†ç¾¤å†…ä¼šè‡ªåŠ¨é‡ç»„ï¼Œå¦‚å›¾")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125114656253-121641653.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("åœ¨ Node 1 å’Œ Node 2 ä¸­åˆ†åˆ«ä¼šæœ‰ä¸€ä¸ªåˆ†ç‰‡è¢«ç§»åŠ¨åˆ° Node 3 ä¸Šï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šå°±éƒ½åªæœ‰ä¸¤ä¸ªåˆ†ç‰‡äº†ã€‚è¿™æ„å‘³ç€æ¯ä¸ªèŠ‚ç‚¹çš„ç¡¬ä»¶èµ„æºï¼ˆCPUã€RAMã€I/Oï¼‰è¢«æ›´å°‘çš„åˆ†ç‰‡å…±äº«ï¼Œæ‰€ä»¥æ¯ä¸ªåˆ†ç‰‡å°±ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°")])]),t._v(" "),a("li",[a("strong",[t._v("ä¸€å…±æœ‰6ä¸ªåˆ†ç‰‡ï¼ˆ3ä¸ªä¸»åˆ†ç‰‡å’Œ3ä¸ªä»åˆ†ç‰‡ï¼‰ï¼Œå› æ­¤æœ€å¤šå¯ä»¥æ‰©å±•åˆ°6ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªåˆ†ç‰‡ï¼Œè¿™æ ·æ¯ä¸ªåˆ†ç‰‡éƒ½å¯ä»¥ä½¿ç”¨åˆ°æ‰€åœ¨èŠ‚ç‚¹100%çš„èµ„æºäº†")])]),t._v(" "),a("li",[a("strong",[t._v("ä¸»åˆ†ç‰‡çš„æ•°é‡åœ¨ç´¢å¼•åˆ›å»ºçš„æ—¶å€™å°±å·²ç»æŒ‡å®šäº†ï¼Œå®é™…ä¸Šï¼Œè¿™ä¸ªæ•°å­—å®šä¹‰äº†èƒ½å­˜å‚¨åˆ°ç´¢å¼•ä¸­çš„æ•°æ®æœ€å¤§é‡ï¼ˆå…·ä½“çš„æ•°é‡å–å†³äºä½ çš„æ•°æ®ï¼Œç¡¬ä»¶çš„ä½¿ç”¨æƒ…å†µï¼‰ã€‚ä¾‹å¦‚ï¼Œè¯»è¯·æ±‚â€”â€”æœç´¢æˆ–è€…æ–‡æ¡£æ¢å¤å°±å¯ä»¥ç”±ä¸»åˆ†ç‰‡æˆ–è€…ä»åˆ†ç‰‡æ¥æ‰§è¡Œï¼Œæ‰€ä»¥å½“ä½ æ‹¥æœ‰æ›´å¤šä»½æ•°æ®çš„æ—¶å€™ï¼Œä½ å°±æ‹¥æœ‰äº†æ›´å¤§çš„ååé‡")])]),t._v(" "),a("li",[a("strong",[t._v("PUT /blogs/****_settings")]),t._v(" "),a("strong",[t._v("{")]),t._v(" "),a("strong",[t._v('"'),a("strong",[a("strong",[t._v("number_of_replicas")])]),t._v('"****: 2')]),t._v(" "),a("strong",[t._v("}")]),t._v(" "),a("strong",[t._v("ä»åˆ†ç‰‡çš„æ•°é‡å¯ä»¥åœ¨è¿è¡Œçš„é›†ç¾¤ä¸­åŠ¨æ€çš„è°ƒæ•´ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ‰©å±•æˆ–è€…ç¼©å°è§„æ¨¡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥å¢åŠ ä¸€ä¸‹ä»åˆ†ç‰‡ç»„çš„æ•°é‡ï¼š")])]),t._v(" "),a("li",[t._v("**Â ç°åœ¨ blogs çš„ç´¢å¼•æ€»å…±æœ‰9ä¸ªåˆ†ç‰‡ï¼š3ä¸ªä¸»åˆ†ç‰‡å’Œ6ä¸ªä»åˆ†ç‰‡ï¼Œ åˆä¼šå˜æˆä¸€ä¸ªèŠ‚ç‚¹ä¸€ä¸ªåˆ†ç‰‡çš„çŠ¶æ€äº†,æœ€ç»ˆå¾—åˆ°äº†ä¸‰å€æœç´¢æ€§èƒ½çš„ä¸‰èŠ‚ç‚¹é›†ç¾¤**")]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125115353034-132051281.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("è¯´æ˜ï¼šä»…ä»…æ˜¯åœ¨åŒæ ·æ•°é‡çš„èŠ‚ç‚¹ä¸Šå¢åŠ ä»åˆ†ç‰‡çš„æ•°é‡æ˜¯æ ¹æœ¬ä¸èƒ½æé«˜æ€§èƒ½çš„ï¼Œå› ä¸ºæ¯ä¸ªåˆ†ç‰‡éƒ½æœ‰è®¿é—®ç³»ç»Ÿèµ„æºçš„æƒé™ã€‚ä½ éœ€è¦å‡çº§ç¡¬ä»¶é…ç½®ä»¥æé«˜ååé‡ã€‚")])]),t._v(" "),a("li",[a("strong",[t._v("å°è¯•ä¸€ä¸‹,æŠŠç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ€æ‰ï¼Œæˆ‘ä»¬çš„é›†ç¾¤å°±ä¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")])]),t._v(" "),a("li",[a("img",{attrs:{src:"https://images2015.cnblogs.com/blog/1004194/201611/1004194-20161125115935112-1907307214.png",alt:""}})]),t._v(" "),a("li",[a("strong",[t._v("è¢«æ€æ‰çš„èŠ‚ç‚¹æ˜¯ä¸»èŠ‚ç‚¹ï¼Œä¸»åˆ†ç‰‡ 1 å’Œ 2 åœ¨æˆ‘ä»¬æ€æ‰ Node 1 åå°±ä¸¢å¤±äº†ï¼Œæˆ‘ä»¬çš„ç´¢å¼•åœ¨ä¸¢å¤±ä¸»èŠ‚ç‚¹çš„æ—¶å€™æ˜¯ä¸èƒ½æ­£å¸¸å·¥ä½œçš„ã€‚å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªæ—¶å€™æ£€æŸ¥é›†ç¾¤å¥åº·çŠ¶æ€ï¼Œå°†ä¼šæ˜¾ç¤º redï¼šå­˜åœ¨ä¸å¯ç”¨çš„ä¸»èŠ‚ç‚¹")])]),t._v(" "),a("li",[a("strong",[t._v("è€Œä¸ºäº†é›†ç¾¤çš„æ­£å¸¸å·¥ä½œå¿…é¡»éœ€è¦ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œæ‰€ä»¥é¦–å…ˆè¿›è¡Œçš„è¿›ç¨‹å°±æ˜¯ä»å„èŠ‚ç‚¹ä¸­é€‰æ‹©äº†ä¸€ä¸ªæ–°çš„ä¸»èŠ‚ç‚¹ï¼šNode 2")])]),t._v(" "),a("li",[a("strong",[t._v("æ–°çš„ä¸»èŠ‚ç‚¹æ‰€å®Œæˆçš„ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯å°†è¿™äº›åœ¨ Node 2 å’Œ Node 3 ä¸Šçš„ä»åˆ†ç‰‡æå‡ä¸ºä¸»åˆ†ç‰‡ï¼Œç„¶åé›†ç¾¤çš„å¥åº·çŠ¶æ€å°±å˜å›è‡³ yellowã€‚è¿™ä¸ªæå‡çš„è¿›ç¨‹æ˜¯ç¬é—´å®Œæˆäº†ï¼Œå°±å¥½åƒæŒ‰äº†ä¸€ä¸‹å¼€å…³")])]),t._v(" "),a("li",[a("strong",[t._v("å¦‚æœå†æ¬¡æ€æ‰ Node 2 çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç¨‹åºä¾æ—§å¯ä»¥åœ¨æ²¡æœ‰ä¸¢å¤±ä»»ä½•æ•°æ®çš„æƒ…å†µä¸‹è¿è¡Œï¼Œå› ä¸º Node 3 ä¸­ä¾æ—§æ‹¥æœ‰æ¯ä¸ªåˆ†ç‰‡çš„å¤‡ä»½")])]),t._v(" "),a("li",[a("strong",[t._v("å¦‚æœæˆ‘ä»¬é‡å¯ Node 1ï¼Œé›†ç¾¤å°±èƒ½å¤Ÿé‡æ–°åˆ†é…ä¸¢å¤±çš„ä»åˆ†ç‰‡ï¼Œè¿™æ ·ç»“æœå°±ä¼šä¸ä¸‰èŠ‚ç‚¹ä¸¤ä»é›†ç¾¤ä¸€è‡´ã€‚å¦‚æœ Node 1 ä¾æ—§è¿˜æœ‰æ—§èŠ‚ç‚¹çš„å†…å®¹ï¼Œç³»ç»Ÿä¼šå°è¯•é‡æ–°åˆ©ç”¨ä»–ä»¬ï¼Œå¹¶åªä¼šå¤åˆ¶åœ¨æ•…éšœæœŸé—´çš„å˜æ›´æ•°æ®")])])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-2"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-3"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-4"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-5"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-6"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-7"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-8"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"-9"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-9"}},[t._v("#")])]),t._v(" "),a("h3",{attrs:{id:"elasticsearché›†ç¾¤çš„èŠ‚ç‚¹ç±»å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearché›†ç¾¤çš„èŠ‚ç‚¹ç±»å‹"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Elasticsearché›†ç¾¤çš„èŠ‚ç‚¹ç±»å‹")])]),t._v(" "),a("p",[t._v("Elasticsearchçš„ä¸€ä¸ªå®ä¾‹æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€ç»„èŠ‚ç‚¹å½¢æˆä¸€ä¸ªé›†ç¾¤ã€‚Elasticsearché›†ç¾¤ä¸­çš„èŠ‚ç‚¹å¯ä»¥é€šè¿‡ä¸‰ç§ä¸åŒçš„æ–¹å¼è¿›è¡Œé…ç½®ï¼š")]),t._v(" "),a("h4",{attrs:{id:"masterèŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#masterèŠ‚ç‚¹"}},[t._v("#")]),t._v(" "),a("strong",[t._v("MasterèŠ‚ç‚¹")])]),t._v(" "),a("p",[t._v("MasterèŠ‚ç‚¹æ§åˆ¶Elasticsearché›†ç¾¤ï¼Œå¹¶è´Ÿè´£åœ¨é›†ç¾¤èŒƒå›´å†…åˆ›å»º/åˆ é™¤ç´¢å¼•ï¼Œè·Ÿè¸ªå“ªäº›èŠ‚ç‚¹æ˜¯é›†ç¾¤çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å°†åˆ†ç‰‡åˆ†é…ç»™è¿™äº›èŠ‚ç‚¹ã€‚ä¸»èŠ‚ç‚¹ä¸€æ¬¡å¤„ç†ä¸€ä¸ªé›†ç¾¤çŠ¶æ€ï¼Œå¹¶å°†çŠ¶æ€å¹¿æ’­åˆ°æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹éœ€è¦å“åº”å¹¶ç¡®è®¤ä¸»èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚")]),t._v(" "),a("p",[t._v("åœ¨elasticsearch.ymlä¸­ï¼Œå°†nodes.masterå±æ€§è®¾ç½®ä¸ºtrueï¼ˆé»˜è®¤ï¼‰ï¼Œå¯ä»¥å°†èŠ‚ç‚¹é…ç½®ä¸ºæœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚")]),t._v(" "),a("p",[t._v("å¯¹äºå¤§å‹ç”Ÿäº§é›†ç¾¤ï¼Œå»ºè®®ç”¨ä¸€ä¸ªä¸“ç”¨ä¸»èŠ‚ç‚¹æ¥æ§åˆ¶é›†ç¾¤ï¼Œå¹¶ä¸”ä¸æœåŠ¡ä»»ä½•ç”¨æˆ·è¯·æ±‚ã€‚")]),t._v(" "),a("h4",{attrs:{id:"dataèŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dataèŠ‚ç‚¹"}},[t._v("#")]),t._v(" "),a("strong",[t._v("DataèŠ‚ç‚¹")])]),t._v(" "),a("p",[t._v("æ•°æ®èŠ‚ç‚¹ç”¨æ¥ä¿å­˜æ•°æ®å’Œå€’æ’ç´¢å¼•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½é…ç½®ä¸ºä¸€ä¸ªdataèŠ‚ç‚¹ï¼Œå¹¶ä¸”åœ¨elasticsearch.ymlä¸­å°†å±æ€§node.dataè®¾ç½®ä¸ºtrueã€‚å¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªä¸“ç”¨çš„masterèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°†node.dataå±æ€§æ›´æ”¹ä¸ºfalseã€‚")]),t._v(" "),a("h4",{attrs:{id:"clientèŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clientèŠ‚ç‚¹"}},[t._v("#")]),t._v(" "),a("strong",[t._v("ClientèŠ‚ç‚¹")])]),t._v(" "),a("p",[t._v("å¦‚æœå°†node.masterå’Œnode.dataè®¾ç½®ä¸ºfalseï¼Œåˆ™å°†èŠ‚ç‚¹é…ç½®ä¸ºå®¢æˆ·ç«¯èŠ‚ç‚¹ï¼Œå¹¶å……å½“è´Ÿè½½å¹³è¡¡å™¨ï¼Œå°†ä¼ å…¥çš„è¯·æ±‚è·¯ç”±åˆ°é›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹ã€‚")]),t._v(" "),a("p",[t._v("è‹¥ä½ è¿æ¥çš„æ˜¯ä½œä¸ºå®¢æˆ·ç«¯çš„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ç§°ä¸ºåè°ƒèŠ‚ç‚¹(coordinating node)ã€‚åè°ƒèŠ‚ç‚¹å°†å®¢æˆ·æœºè¯·æ±‚è·¯ç”±åˆ°é›†ç¾¤ä¸­å¯¹åº”åˆ†ç‰‡æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚å¯¹äºè¯»å–è¯·æ±‚ï¼Œåè°ƒèŠ‚ç‚¹æ¯æ¬¡é€‰æ‹©ä¸åŒçš„åˆ†ç‰‡æ¥æä¾›è¯·æ±‚ä»¥å¹³è¡¡è´Ÿè½½ã€‚")]),t._v(" "),a("p",[t._v("åœ¨æˆ‘ä»¬å¼€å§‹å®¡æŸ¥å‘é€åˆ°åè°ƒèŠ‚ç‚¹çš„CRUDè¯·æ±‚å¦‚ä½•é€šè¿‡é›†ç¾¤ä¼ æ’­å¹¶ç”±å¼•æ“æ‰§è¡Œä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹Elasticsearchå¦‚ä½•åœ¨å†…éƒ¨å­˜å‚¨æ•°æ®ï¼Œä»¥ä½å»¶è¿Ÿä¸ºå…¨æ–‡æœç´¢æä¾›ç»“æœã€‚")]),t._v(" "),a("h4",{attrs:{id:"å­˜å‚¨æ¨¡å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å­˜å‚¨æ¨¡å‹"}},[t._v("#")]),t._v(" "),a("strong",[t._v("å­˜å‚¨æ¨¡å‹")])]),t._v(" "),a("p",[t._v("Elasticsearchä½¿ç”¨Apache Luceneï¼Œå®ƒæ˜¯ç”±Javaç¼–å†™çš„å…¨æ–‡æœç´¢åº“ï¼Œç”±Doug Cuttingï¼ˆApache Hadoopçš„åˆ›å»ºè€…ï¼‰å†…éƒ¨å¼€å‘ï¼Œå®ƒä½¿ç”¨ç§°ä¸ºå€’æ’ç´¢å¼•çš„æ•°æ®ç»“æ„ï¼Œç”¨äºæä¾›ä½å»¶è¿Ÿæœç´¢ç»“æœã€‚")]),t._v(" "),a("p",[t._v("æ–‡æ¡£ï¼ˆdocumentï¼‰æ˜¯Elasticsearchä¸­çš„æ•°æ®å•ä½ï¼Œå¹¶é€šè¿‡å¯¹æ–‡æ¡£ä¸­çš„æœ¯è¯­è¿›è¡Œæ ‡è®°æ¥åˆ›å»ºå€’æ’ç´¢å¼•ï¼Œåˆ›å»ºæ‰€æœ‰å”¯ä¸€æœ¯è¯­çš„æ’åºåˆ—è¡¨ï¼Œå¹¶å°†æ–‡æ¡£åˆ—è¡¨ä¸å¯ä»¥æ‰¾åˆ°è¯¥è¯çš„ä½ç½®ç›¸å…³è”ã€‚")]),t._v(" "),a("p",[t._v("å®ƒéå¸¸ç±»ä¼¼äºä¸€æœ¬ä¹¦èƒŒé¢çš„ç´¢å¼•ï¼Œå…¶ä¸­åŒ…å«ä¹¦ä¸­çš„æ‰€æœ‰ç‹¬ç‰¹çš„å•è¯å’Œå¯ä»¥æ‰¾åˆ°è¯¥å•è¯çš„é¡µé¢åˆ—è¡¨ã€‚å½“æˆ‘ä»¬è¯´ä¸€ä¸ªæ–‡æ¡£è¢«ç´¢å¼•æ—¶ï¼Œæˆ‘ä»¬å¼•ç”¨å€’æ’ç´¢å¼•ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸¤ä¸ªæ–‡æ¡£çš„å€’æ’ç´¢å¼•å¦‚ä½•çœ‹å¾…ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdn.net/20170814225953744?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemdfaG92ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast",alt:""}})]),t._v(" "),a("p",[t._v("å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰¾åˆ°åŒ…å«æœ¯è¯­â€œinsightâ€çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥æ‰«æå€’æ’çš„ç´¢å¼•ï¼ˆåœ¨å“ªé‡Œæ’åºï¼‰ï¼Œæ‰¾åˆ°â€œinsightâ€è¿™ä¸ªè¯ï¼Œå¹¶è¿”å›åŒ…å«è¿™ä¸ªå•è¯çš„æ–‡æ¡£IDï¼Œè¿™åœ¨è¿™ç§æƒ…å†µä¸‹å°†æ˜¯æ–‡æ¡£1å’ŒDoc 2å·æ–‡ä»¶ã€‚")]),t._v(" "),a("p",[t._v("ä¸ºäº†æé«˜å¯æœç´¢æ€§ï¼ˆä¾‹å¦‚ï¼Œä¸ºå°å†™å­—æ¯å’Œå°å†™å­—æä¾›ç›¸åŒçš„ç»“æœï¼‰ï¼Œé¦–å…ˆåˆ†ææ–‡æ¡£å¹¶å¯¹å…¶è¿›è¡Œç´¢å¼•ã€‚")]),t._v(" "),a("p",[t._v("åˆ†æç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š")]),t._v(" "),a("p",[t._v("å°†å¥å­æ ‡è®°æˆå•è¯")]),t._v(" "),a("p",[t._v("å°†å•è¯è§„èŒƒåŒ–ä¸ºæ ‡å‡†è¡¨å•")]),t._v(" "),a("p",[t._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchä½¿ç”¨æ ‡å‡†åˆ†æå™¨")]),t._v(" "),a("p",[t._v("æ ‡å‡†æ ‡è®°å™¨(Standard tokenizer)ï¼Œç”¨äºåœ¨å•è¯è¾¹ç•Œä¸Šåˆ†å‰²å•è¯")]),t._v(" "),a("p",[t._v("å°å†™ä»¤ç‰Œè¿‡æ»¤å™¨(Lowercase token filter)å°†å•è¯è½¬æ¢ä¸ºå°å†™")]),t._v(" "),a("p",[t._v("è¿˜æœ‰è®¸å¤šå…¶ä»–åˆ†æä»ªå¯ç”¨ï¼Œæ‚¨å¯ä»¥åœ¨æ–‡æ¡£ä¸­é˜…è¯»å®ƒä»¬ã€‚")]),t._v(" "),a("p",[t._v("æ³¨æ„ï¼šæ ‡å‡†åˆ†æä»ªä¹Ÿä½¿ç”¨åœæ­¢ä»¤ç‰Œè¿‡æ»¤å™¨ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å®ç°åŸç†åˆ†æ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°åŸç†åˆ†æ"}},[t._v("#")]),t._v(" "),a("strong",[t._v("å®ç°åŸç†åˆ†æ")])]),t._v(" "),a("h3",{attrs:{id:"write-å†™-create-åˆ›å»º-æ“ä½œå®ç°åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#write-å†™-create-åˆ›å»º-æ“ä½œå®ç°åŸç†"}},[t._v("#")]),t._v(" "),a("strong",[t._v("write(å†™)/create(åˆ›å»º)æ“ä½œå®ç°åŸç†")])]),t._v(" "),a("p",[t._v("å½“æ‚¨å‘åè°ƒèŠ‚ç‚¹å‘é€è¯·æ±‚ä»¥ç´¢å¼•æ–°æ–‡æ¡£æ—¶ï¼Œå°†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š")]),t._v(" "),a("p",[t._v("æ‰€æœ‰åœ¨Elasticsearché›†ç¾¤ä¸­çš„èŠ‚ç‚¹éƒ½åŒ…å«ï¼šæœ‰å…³å“ªä¸ªåˆ†ç‰‡å­˜åœ¨äºå“ªä¸ªèŠ‚ç‚¹ä¸Šçš„å…ƒæ•°æ®ã€‚åè°ƒèŠ‚ç‚¹(coordinating node)ä½¿ç”¨æ–‡æ¡£IDï¼ˆé»˜è®¤ï¼‰å°†æ–‡æ¡£è·¯ç”±åˆ°å¯¹åº”çš„åˆ†ç‰‡ã€‚Elasticsearchå°†æ–‡æ¡£IDä»¥murmur3ä½œä¸ºæ•£åˆ—å‡½æ•°è¿›è¡Œæ•£åˆ—ï¼Œå¹¶é€šè¿‡ç´¢å¼•ä¸­çš„ä¸»åˆ†ç‰‡æ•°é‡è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œä»¥ç¡®å®šæ–‡æ¡£åº”è¢«ç´¢å¼•åˆ°å“ªä¸ªåˆ†ç‰‡ã€‚")]),t._v(" "),a("p",[t._v("shard = hash(document_id) % (num_of_primary_shards)")]),t._v(" "),a("p",[t._v("å½“èŠ‚ç‚¹æ¥æ”¶åˆ°æ¥è‡ªåè°ƒèŠ‚ç‚¹çš„è¯·æ±‚æ—¶ï¼Œè¯·æ±‚è¢«å†™å…¥åˆ°translogï¼ˆæˆ‘ä»¬å°†åœ¨åç»­çš„postä¸­é—´è®²è§£translogï¼‰ï¼Œå¹¶å°†è¯¥æ–‡æ¡£æ·»åŠ åˆ°å†…å­˜ç¼“å†²åŒºã€‚å¦‚æœè¯·æ±‚åœ¨ä¸»åˆ†ç‰‡ä¸ŠæˆåŠŸï¼Œåˆ™è¯·æ±‚å°†å¹¶è¡Œå‘é€åˆ°å‰¯æœ¬åˆ†ç‰‡ã€‚åªæœ‰åœ¨æ‰€æœ‰ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡ä¸Šçš„translogè¢«fsyncâ€™edåï¼Œå®¢æˆ·ç«¯æ‰ä¼šæ”¶åˆ°è¯¥è¯·æ±‚æˆåŠŸçš„ç¡®è®¤ã€‚")]),t._v(" "),a("p",[t._v("å†…å­˜ç¼“å†²åŒºä»¥å›ºå®šçš„é—´éš”åˆ·æ–°ï¼ˆé»˜è®¤ä¸º1ç§’ï¼‰ï¼Œå¹¶å°†å†…å®¹å†™å…¥æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸­çš„æ–°æ®µã€‚æ­¤åˆ†æ®µçš„å†…å®¹æ›´å°šæœªè¢«fsyncâ€™ed(æœªè¢«å†™å…¥æ–‡ä»¶ç³»ç»Ÿ)ï¼Œåˆ†æ®µæ˜¯æ‰“å¼€çš„ï¼Œå†…å®¹å¯ç”¨äºæœç´¢ã€‚")]),t._v(" "),a("p",[t._v("translogè¢«æ¸…ç©ºï¼Œå¹¶ä¸”æ–‡ä»¶ç³»ç»Ÿç¼“å­˜æ¯éš”30åˆ†é’Ÿè¿›è¡Œä¸€æ¬¡fsyncï¼Œæˆ–è€…å½“translogå˜å¾—å¤ªå¤§æ—¶è¿›è¡Œä¸€æ¬¡fsyncã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨Elasticsearchä¸­ç§°ä¸ºflushã€‚åœ¨åˆ·æ–°è¿‡ç¨‹ä¸­ï¼Œå†…å­˜ç¼“å†²åŒºè¢«æ¸…é™¤ï¼Œå†…å®¹è¢«å†™å…¥æ–°çš„æ–‡ä»¶åˆ†æ®µ(segment)ã€‚å½“æ–‡ä»¶åˆ†æ®µè¢«fsyncâ€™edå¹¶åˆ·æ–°åˆ°ç£ç›˜ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ç‚¹ï¼ˆå…¶å®å°±æ˜¯ä¼šæ›´æ–°æ–‡ä»¶åç§»é‡ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šè‡ªåŠ¨åšè¿™ä¸ªæ“ä½œï¼‰ã€‚æ—§çš„translogè¢«åˆ é™¤ï¼Œä¸€ä¸ªæ–°çš„å¼€å§‹ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹å›¾æ˜¾ç¤ºäº†å†™å…¥è¯·æ±‚å’Œæ•°æ®æµç¨‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdn.net/20170814230326817?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemdfaG92ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"updateå’Œdeleteå®ç°åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updateå’Œdeleteå®ç°åŸç†"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Updateå’ŒDeleteå®ç°åŸç†")])]),t._v(" "),a("p",[t._v("åˆ é™¤å’Œæ›´æ–°æ“ä½œä¹Ÿæ˜¯å†™æ“ä½œã€‚ä½†æ˜¯ï¼ŒElasticsearchä¸­çš„æ–‡æ¡£æ˜¯ä¸å¯å˜çš„(immutable)ï¼Œå› æ­¤ä¸èƒ½åˆ é™¤æˆ–ä¿®æ”¹ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•åˆ é™¤/æ›´æ–°æ–‡æ¡£å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("ç£ç›˜ä¸Šçš„æ¯ä¸ªåˆ†æ®µ(segment)éƒ½æœ‰ä¸€ä¸ª.delæ–‡ä»¶ä¸å®ƒç›¸å…³è”ã€‚å½“å‘é€åˆ é™¤è¯·æ±‚æ—¶ï¼Œè¯¥æ–‡æ¡£æœªè¢«çœŸæ­£åˆ é™¤ï¼Œè€Œæ˜¯åœ¨.delæ–‡ä»¶ä¸­æ ‡è®°ä¸ºå·²åˆ é™¤ã€‚æ­¤æ–‡æ¡£å¯èƒ½ä»ç„¶èƒ½è¢«æœç´¢åˆ°ï¼Œä½†ä¼šä»ç»“æœä¸­è¿‡æ»¤æ‰ã€‚å½“åˆ†æ®µåˆå¹¶æ—¶ï¼ˆæˆ‘ä»¬å°†åœ¨åç»­çš„å¸–å­ä¸­åŒ…æ‹¬æ®µåˆå¹¶ï¼‰ï¼Œåœ¨.delæ–‡ä»¶ä¸­æ ‡è®°ä¸ºå·²åˆ é™¤çš„æ–‡æ¡£ä¸ä¼šè¢«åŒ…æ‹¬åœ¨æ–°çš„åˆå¹¶æ®µä¸­ã€‚")]),t._v(" "),a("p",[t._v("ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ›´æ–°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚åˆ›å»ºæ–°æ–‡æ¡£æ—¶ï¼ŒElasticsearchå°†ä¸ºè¯¥æ–‡æ¡£åˆ†é…ä¸€ä¸ªç‰ˆæœ¬å·ã€‚å¯¹æ–‡æ¡£çš„æ¯æ¬¡æ›´æ”¹éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç‰ˆæœ¬å·ã€‚å½“æ‰§è¡Œæ›´æ–°æ—¶ï¼Œæ—§ç‰ˆæœ¬åœ¨.delæ–‡ä»¶ä¸­è¢«æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œå¹¶ä¸”æ–°ç‰ˆæœ¬åœ¨æ–°çš„åˆ†æ®µä¸­ç¼–å…¥ç´¢å¼•ã€‚æ—§ç‰ˆæœ¬å¯èƒ½ä»ç„¶ä¸æœç´¢æŸ¥è¯¢åŒ¹é…ï¼Œä½†æ˜¯ä»ç»“æœä¸­å°†å…¶è¿‡æ»¤æ‰ã€‚")]),t._v(" "),a("p",[t._v("indexed/updatedæ–‡æ¡£åï¼Œæˆ‘ä»¬å¸Œæœ›æ‰§è¡Œæœç´¢è¯·æ±‚ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨Elasticsearchä¸­æ‰§è¡Œæœç´¢è¯·æ±‚ã€‚")]),t._v(" "),a("h3",{attrs:{id:"readçš„å®ç°åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#readçš„å®ç°åŸç†"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Readçš„å®ç°åŸç†")])]),t._v(" "),a("p",[t._v("è¯»æ“ä½œç”±ä¸¤ä¸ªé˜¶æ®µç»„æˆï¼š")]),t._v(" "),a("p",[t._v("æŸ¥è¯¢é˜¶æ®µï¼ˆQuery Phaseï¼‰")]),t._v(" "),a("p",[t._v("è·å–é˜¶æ®µï¼ˆFetch Phaseï¼‰")]),t._v(" "),a("h4",{attrs:{id:"æŸ¥è¯¢é˜¶æ®µ-query-phase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥è¯¢é˜¶æ®µ-query-phase"}},[t._v("#")]),t._v(" "),a("strong",[t._v("æŸ¥è¯¢é˜¶æ®µ(Query Phase)")])]),t._v(" "),a("p",[t._v("åœ¨æ­¤é˜¶æ®µï¼Œåè°ƒèŠ‚ç‚¹å°†æœç´¢è¯·æ±‚è·¯ç”±åˆ°ç´¢å¼•(index)ä¸­çš„æ‰€æœ‰åˆ†ç‰‡(shards)ï¼ˆåŒ…æ‹¬ï¼šä¸»è¦æˆ–å‰¯æœ¬ï¼‰ã€‚åˆ†ç‰‡ç‹¬ç«‹æ‰§è¡Œæœç´¢ï¼Œå¹¶æ ¹æ®ç›¸å…³æ€§åˆ†æ•°åˆ›å»ºä¸€ä¸ªä¼˜å…ˆçº§æ’åºç»“æœï¼ˆç¨åæˆ‘ä»¬å°†ä»‹ç»ç›¸å…³æ€§åˆ†æ•°ï¼‰ã€‚æ‰€æœ‰åˆ†ç‰‡å°†åŒ¹é…çš„æ–‡æ¡£å’Œç›¸å…³åˆ†æ•°çš„æ–‡æ¡£IDè¿”å›ç»™åè°ƒèŠ‚ç‚¹ã€‚åè°ƒèŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå¹¶å¯¹å…¨å±€ç»“æœè¿›è¡Œæ’åºã€‚å¯ä»¥æœ‰å¾ˆå¤šæ–‡æ¡£åŒ¹é…ç»“æœï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†ç‰‡å°†å‰10ä¸ªç»“æœå‘é€åˆ°åè°ƒèŠ‚ç‚¹ï¼Œåè°ƒåˆ›å»ºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä»æ‰€æœ‰åˆ†ç‰‡ä¸­åˆ†é€‰ç»“æœå¹¶è¿”å›å‰10ä¸ªåŒ¹é…ã€‚")]),t._v(" "),a("h4",{attrs:{id:"è·å–é˜¶æ®µ-fetch-phase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è·å–é˜¶æ®µ-fetch-phase"}},[t._v("#")]),t._v(" "),a("strong",[t._v("è·å–é˜¶æ®µ(Fetch Phase)")])]),t._v(" "),a("p",[t._v("åœ¨åè°ƒèŠ‚ç‚¹å¯¹æ‰€æœ‰ç»“æœè¿›è¡Œæ’åºï¼Œå·²ç”Ÿæˆå…¨å±€æ’åºçš„æ–‡æ¡£åˆ—è¡¨åï¼Œå®ƒå°†ä»æ‰€æœ‰åˆ†ç‰‡è¯·æ±‚åŸå§‹æ–‡æ¡£ã€‚")]),t._v(" "),a("p",[t._v("æ‰€æœ‰çš„åˆ†ç‰‡éƒ½ä¼šä¸°å¯Œæ–‡æ¡£å¹¶å°†å…¶è¿”å›åˆ°åè°ƒèŠ‚ç‚¹ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdn.net/20170814230558199?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemdfaG92ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast",alt:""}})]),t._v(" "),a("p",[t._v("å¦‚ä¸Šæ‰€è¿°ï¼Œæœç´¢ç»“æœæŒ‰ç›¸å…³æ€§æ’åºã€‚æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ç›¸å…³æ€§çš„å®šä¹‰ã€‚")]),t._v(" "),a("h4",{attrs:{id:"æœç´¢ç›¸å…³æ€§-search-relevance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æœç´¢ç›¸å…³æ€§-search-relevance"}},[t._v("#")]),t._v(" "),a("strong",[t._v("æœç´¢ç›¸å…³æ€§(Search Relevance)")])]),t._v(" "),a("p",[t._v("ç›¸å…³æ€§ç”±Elasticsearchç»™äºˆæœç´¢ç»“æœä¸­è¿”å›çš„æ¯ä¸ªæ–‡æ¡£çš„åˆ†æ•°ç¡®å®šã€‚ç”¨äºè¯„åˆ†çš„é»˜è®¤ç®—æ³•ä¸ºtf / idfï¼ˆæœ¯è¯­é¢‘ç‡/é€†æ–‡æ¡£é¢‘ç‡ï¼‰ã€‚è¯¥æœ¯è¯­é¢‘ç‡æµ‹é‡æœ¯è¯­å‡ºç°åœ¨æ–‡æ¡£ä¸­çš„æ¬¡æ•°ï¼ˆæ›´é«˜é¢‘ç‡=æ›´é«˜çš„ç›¸å…³æ€§ï¼‰ï¼Œé€†æ–‡æ¡£é¢‘ç‡æµ‹é‡æœ¯è¯­åœ¨æ•´ä¸ªç´¢å¼•ä¸­å‡ºç°çš„é¢‘ç‡å ç´¢å¼•ä¸­æ–‡æ¡£æ€»æ•°çš„ç™¾åˆ†æ¯”ï¼ˆæ›´é«˜çš„é¢‘ç‡")]),t._v(" "),a("p",[t._v("==è¾ƒå°‘çš„ç›¸å…³æ€§ï¼‰ã€‚æœ€ç»ˆå¾—åˆ†æ˜¯tf-idfåˆ†æ•°ä¸å…¶ä»–å› ç´ ï¼ˆå¦‚è¯è¯­é‚»è¿‘åº¦ï¼ˆçŸ­è¯­æŸ¥è¯¢ï¼‰ï¼‰ï¼Œæœ¯è¯­ç›¸ä¼¼åº¦ï¼ˆç”¨äºæ¨¡ç³ŠæŸ¥è¯¢ï¼‰ç­‰çš„ç»„åˆã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker run -dti --network=host --name=elasticsearch -v\n/home/python/elasticsearch-2.4.6/config:/usr/share/elasticsearch/config delron/elasticsearch-ik:2.4.6-1.0\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);